---
title: "PUBH 7462 Homework 2"
author: "Chris Wojan"
date: "2/10/2022"
output: github_document
---

### Problem 3.1
#### Data Exploration and Cleaning

Data exploration code is hidden, but data cleaning code is presented below:

```{r setup, include = FALSE}

## Load libraries
library(tidyverse)
library(DataExplorer)
library(janitor)

## Set knitr options
knitr::opts_chunk$set(echo = TRUE)

## Set Theme for ggplot2 - centers title and legend at bottom by default
theme_set(theme_bw() + 
          theme(plot.title = element_text(hjust = 0.5), legend.position = "bottom"))

## Set Scientific notation output and decimal places for knitr
options(scipen = 999)
options(digits = 4)
```

```{r 3.1_data_explore, include = FALSE}

## Read in BRFSS SMART County Prevalence data
brfss_data <- read_csv("./data/brfss_smart_2010.csv")

## Check some basic features of the data
introduce(brfss_data)
plot_intro(brfss_data)
plot_str(brfss_data)
plot_missing(brfss_data)
plot_histogram(brfss_data)

```

```{r 3.1_data_clean, echo = TRUE, results = FALSE}

### "Clean" the data

## Make column (variable) names consistent
brfss_clean <- clean_names(brfss_data) 

## Subset the data that we are interested in
brfss_clean <- brfss_clean %>%
  separate(col = locationdesc, into = c("state", "county"), sep = " - ") %>%
  filter(topic %in% "Overall Health") %>%
  select(year, state, county, response, sample_size, data_value)

## Check if column types need to be reformatted
str(brfss_clean)

## Format variables that represent categories as factors
brfss_clean <- brfss_clean %>%
  mutate(
    state = factor(state),
    county = str_remove(county, " County") %>%
      factor(),
    response = factor(response)
  )

## Check response level order
levels(brfss_clean$response)

## Reorder response levels by ordinal position
brfss_clean$response <- fct_relevel(brfss_clean$response, 
                                    c("Excellent", "Very good", "Good", "Fair", "Poor"))
  
```

### Problem 3.2
#### Data Description

This cleaned BRFSS SMART dataset represents information on the self-reported general health of survey particpants by state and county. It includes `r nrow(brfss_clean)` rows (or observations) and `r ncol(brfss_clean)` columns (or variables). Each observation represents a particular level of general health for a given state, county and year. The variables are as follows:

Variable                  | Description  
------------------------- | ------------------------------------------  
`r names(brfss_clean)[1]` | Year of survey
`r names(brfss_clean)[2]` | US state where survey was conducted
`r names(brfss_clean)[3]` | County where survey was conducted
`r names(brfss_clean)[4]` | Self-reported general health status (Excellent - Poor)
`r names(brfss_clean)[5]` | Number of respondents that reported this health status (#)
`r names(brfss_clean)[6]` | Proportion of respondent that reported this health status (%)

### Problem 3.3
#### 3.3.1

```{r prob_3.3.1, echo = TRUE}

brfss_331 <- brfss_clean %>%
  filter(year == 2004) %>%
  select(year, state, county) %>%
  distinct()

```

The following states featured 6 surveyed counties (or locations): `r names(which(summary(brfss_331$state) == 6))`

#### 3.3.2



